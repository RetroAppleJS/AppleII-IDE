<html>
<head>
    <meta charset='utf-8'>
    <script type="text/javascript" src="../res/showdown.js"></script>
    <link rel="stylesheet" href="../res/COM_markdown.css">
    <style>

/*
       


        body {
          
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px;
  color: #333;
}

body > *:first-child {
  margin-top: 0 !important;
}

body > *:last-child {
  margin-bottom: 0 !important;
}

a {
  color: #4183C4;
  text-decoration: none;
}

a.absent {
  color: #cc0000;
}

a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
}

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative;
}

h2:first-child, h1:first-child, h1:first-child + h2, h3:first-child, h4:first-child, h5:first-child, h6:first-child {
  margin-top: 0;
  padding-top: 0;
}

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  text-decoration: none;
}

h1 tt, h1 code {
  font-size: inherit;
}

h2 tt, h2 code {
  font-size: inherit;
}

h3 tt, h3 code {
  font-size: inherit;
}

h4 tt, h4 code {
  font-size: inherit;
}

h5 tt, h5 code {
  font-size: inherit;
}

h6 tt, h6 code {
  font-size: inherit;
}

h1 {
  font-size: 28px;
  color: black;
}

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black;
}

h3 {
  font-size: 18px;
}

h4 {
  font-size: 16px;
}

h5 {
  font-size: 14px;
}

h6 {
  color: #777777;
  font-size: 14px;
}

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0;
}

hr {
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0;
}

body > h1:first-child {
  margin-top: 0;
  padding-top: 0;
}

body > h1:first-child + h2 {
  margin-top: 0;
  padding-top: 0;
}

body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0;
}

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0;
}

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0;
}

li p.first {
  display: inline-block;
}

ul, ol {
  padding-left: 30px;
}

ul :first-child, ol :first-child {
  margin-top: 0;
}

ul :last-child, ol :last-child {
  margin-bottom: 0;
}

dl {
  padding: 0;
}

dl dt {
  font-size: 14px;
  font-weight: bold;
  font-style: italic;
  padding: 0;
  margin: 15px 0 5px;
}

dl dt:first-child {
  padding: 0;
}

dl dt > :first-child {
  margin-top: 0;
}

dl dt > :last-child {
  margin-bottom: 0;
}

dl dd {
  margin: 0 0 15px;
  padding: 0 15px;
}

dl dd > :first-child {
  margin-top: 0;
}

dl dd > :last-child {
  margin-bottom: 0;
}

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777;
}

blockquote > :first-child {
  margin-top: 0;
}

blockquote > :last-child {
  margin-bottom: 0;
}

table {
  padding: 0;
}
table tr {
  border-top: 1px solid #cccccc;
  background-color: white;
  margin: 0;
  padding: 0;
}

table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

table tr th {
  font-weight: bold;
  border: 1px solid #cccccc;
  text-align: left;
  margin: 0;
  padding: 6px 13px;
}

table tr td {
  border: 1px solid #cccccc;
  text-align: left;
  margin: 0;
  padding: 6px 13px;
}

table tr th :first-child, table tr td :first-child {
  margin-top: 0;
}

table tr th :last-child, table tr td :last-child {
  margin-bottom: 0;
}

img {
  max-width: 100%;
}

span.frame {
  display: block;
  overflow: hidden;
}

span.frame > span {
  border: 1px solid #dddddd;
  display: block;
  float: left;
  overflow: hidden;
  margin: 13px 0 0;
  padding: 7px;
  width: auto;
}

span.frame span img {
  display: block;
  float: left;
}

span.frame span span {
  clear: both;
  color: #333333;
  display: block;
  padding: 5px 0 0;
}

span.align-center {
  display: block;
  overflow: hidden;
  clear: both;
}

span.align-center > span {
  display: block;
  overflow: hidden;
  margin: 13px auto 0;
  text-align: center;
}

span.align-center span img {
  margin: 0 auto;
  text-align: center;
}

span.align-right {
  display: block;
  overflow: hidden;
  clear: both;
}

span.align-right > span {
  display: block;
  overflow: hidden;
  margin: 13px 0 0;
  text-align: right;
}

span.align-right span img {
  margin: 0;
  text-align: right;
}

span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left;
}

span.float-left span {
  margin: 13px 0 0;
}

span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right;
}

span.float-right > span {
  display: block;
  overflow: hidden;
  margin: 13px auto 0;
  text-align: right;
}

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px;
}

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent;
}

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px;
}

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px;
}

pre code, pre tt {
  background-color: transparent;
  border: none;
}
*/
    </style>
</head>
<body>

<script>

  GetHTTP("https://raw.githubusercontent.com/RetroAppleJS/AppleII-IDE/main/README.md",
  function() { process_dir(this.responseText,this.responseURL) } )

  //GetHTTP("https://raw.githubusercontent.com/RetroAppleJS/AppleII-IDE/main/docs/REF_6502.html",
  //function() { toMD(this.responseText,this.responseURL) } )

  function GetHTTP(url,callback_function)
  {
    const xhttp = new XMLHttpRequest();
    xhttp.onload = callback_function;
    xhttp.open("GET", url);
    xhttp.send();
  }

  function Markdown2HTML(md)
  {
    var converter = new showdown.Converter();
    converter.setFlavor("github");
    return converter.makeHtml(md);
  }

  function HTML2Markdown(html)
  {
    var converter = new showdown.Converter();
    converter.setFlavor("github");
    return converter.makeMarkdown(html);
  }

  //                                                     /res/appleIIplus_bck_650.png?raw=true
  // https://github.com/RetroAppleJS/AppleII-IDE/raw/main/res/appleIIplus_bck_650.png?raw=true

  function process(txt,url)
  {
    //var converter = new showdown.Converter();
    //converter.setFlavor("github");
    filename = url.substring(url.lastIndexOf("/")+1,url.length);

    //////////////////// MAKE HTML  //////////////////
    var html = Markdown2HTML(txt);
    html = html.replace(new RegExp('/res/','g'),"https://github.com/RetroAppleJS/AppleII-IDE/raw/main/res/");
    document.getElementById("src").innerHTML      = txt;
    document.getElementById("html_txt").innerHTML = html;
    document.getElementById("html").innerHTML     = html;

    //////////////////// MAKE MARKDOWN //////////////////
    document.getElementById("markdown").innerHTML = HTML2Markdown(html);
    //var html = "<p>TEST</p>";
    var js = "DOCS_"+filename.replace(new RegExp('.md','g'),"")
      +' = "'+(html.replace(new RegExp('\"','g'),'\\"')
                  .replace(new RegExp('\n','g'),"<br>\"\n+\"")
              +"<br>"+"\"\n\n")
              .replace(new RegExp('<br /><br>','g'),"<br>")
              .replace(new RegExp('..https://github.com/RetroAppleJS/AppleII-IDE/raw/main/res/','g'),"res/")
              .replace(new RegExp('</h1>','g'),"</h1><hr>")
              .replace(new RegExp('</h1>','g'),"</h1><hr>")
              .replace(new RegExp('</h2>','g'),"</h2><hr>")
              //.replace(new RegExp('<a ','g'),">")
              .replace(new RegExp('><br>','g'),">")
              .replace(new RegExp('<img ','g'),"<img style=\\\"-webkit-filter: invert(1) sepia(0.75) brightness(0.75) hue-rotate(110deg) brightness(1.3);filter: invert(1) sepia(0.75) brightness(0.75) hue-rotate(110deg) brightness(1.3);\\\" ")

              /*
              .replace(new RegExp('</h3><br>','g'),"</h3>")
              .replace(new RegExp('</h4><br>','g'),"</h4>")
              .replace(new RegExp('</th><br>','g'),"</th>")
              .replace(new RegExp('</tr><br>','g'),"</tr>")
              .replace(new RegExp('</td><br>','g'),"</td>")
              .replace(new RegExp('</thead><br>','g'),"</thead>")
              .replace(new RegExp('</tbody><br>','g'),"</tbody>")                
              .replace(new RegExp('</table><br>','g'),"</table>")   
              .replace(new RegExp('<th><br>','g'),"<th>")
              .replace(new RegExp('<tr><br>','g'),"<tr>")
              .replace(new RegExp('<td><br>','g'),"<td>")
              .replace(new RegExp('<thead><br>','g'),"<thead>")
              .replace(new RegExp('<tbody><br>','g'),"<tbody>")    
              .replace(new RegExp('<table><br>','g'),"<table>")    
                */       
    document.getElementById("dest").innerHTML += js;
    //download('DOCS.js',decodeURIComponent(js));
  }

  function process_dir(txt,url)
  {
    //document.write("<textarea>"+txt+"</textarea>")
    var linkURL = "https://github.com/RetroAppleJS/AppleII-IDE/blob/main/docs/";
    var rawURL = "https://raw.githubusercontent.com/RetroAppleJS/AppleII-IDE/main/docs/";
    var arr = txt.split(linkURL);

    arr[0] = ""; alert(arr.join("\n"));
    for(var i=1;i<arr.length;i++)
    {
      arr[i] = arr[i].substring(0,arr[i].indexOf(".md")+3);
      var url = rawURL + arr[i]
      GetHTTP(url, function() { process(this.responseText,this.responseURL) } );
    }
    
    //alert(arr.join("\n"))
  }

  function toMD(txt,url)
  {
    document.getElementById("dest").innerHTML   = HTML2Markdown(txt);
  }

  // decodeURIComponent

  function download(filename, text)
  {
    var element = document.createElement('a');
    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
    element.setAttribute('download', filename);
    element.style.display = 'none';
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
  }

  
</script>

<table>
<tr>
  <td><textarea id=src style="width:600px;height:180px"></textarea></td>
  <td>>></td>
  <td><textarea id=html_txt style="width:600px;height:180px"></textarea></td>
</tr>
<tr>
  <td><div id=html style="width:600px;height:180px;overflow:scroll;border: 1px solid black;font-size: 13px;"></div></td>
  <td>>></td>
  <td><textarea id=markdown style="width:600px;height:180px"></textarea></td>
</tr>
</table>
<textarea id=dest style="width:1200px;height:180px"></textarea>

<button onclick="download('asmhelp.html',HTML2Markdown(asmHelp()))">Download</button>

</body>
</html>

