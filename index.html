<!DOCTYPE html>
<html>
<head>
    <title>Apple II+ in Javascript</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="icon" type="image/png" sizes="16x16" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAEXRFWHRTb2Z0d2FyZQBKVEwtRGV2J4CxQ84AAAAwUExURf7///7///j4+PLy8u3t7eXl5dvb283NzcLCwrW1ta6urqenp5qamo6OjnV1dWhoaJTpFr4AAAABYktHRACIBR1IAAAACXBIWXMAAB7CAAAewgFu0HU+AAAAAXRSTlMAQObYZgAAAIFJREFUeJwtzTEKwkAQBdC9wp/NkqTcsJC0IVXKlCE3SCrBxjKI6D3sBY9g4R1EEEEbr5AD2Psn8VeP+bM7BoxkwIzhvEAe4wI3QSGnqb43RHdsr/kLRg6lt2Ek9lxIPasLkSh2+o4VCiL6ErFO3oRbA/1Wf948b5/5RBXs6n9d8wM0Ahk+0eMaYgAAAABJRU5ErkJggg==" />
    <!--link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"-->
    <link rel="stylesheet" href="res/COM_fontawesome/all.css">
    <link rel="stylesheet" href="res/COM_MAIN.css">

    <!--
    <link rel="stylesheet" href="res/mocha.css" />
    <style> /* mocha.css style corrector */
    #mocha { margin: 60px 0px }
    #mocha-stats { right: auto }
    </style>
    <script src="res/chai.js"></script>
    <script src="res/mocha.js"></script>
    -->

    <script type="text/javascript" src="res/COM_MAIN.js"></script>
    <script type="text/javascript" src="res/COM_CONFIG.js"></script>  <!-- load all the help, documentation & configuration data-->
    <!--
    <script src='https://cdnjs.cloudflare.com/ajax/libs/gsap/3.1.1/gsap.min.js'></script>
    -->
    <script type="text/javascript" src='res/COM_gsap.js'></script>


    <meta name="viewport" content="width=device-width, initial-scale=1.0" />




    <script id="rendered-js">
      
//   ____    ____          _            
//  |_   \  /   _|        (_)           
//    |   \/   |   ,--.   __   _ .--.   
//    | |\  /| |  `'_\ : [  | [ `.-. |  
//   _| |_\/_| |_ // | |, | |  | | | |  
//  |_____||_____|\'-;__/[___][___||__]
//  ███████  ██████ ██████  ██ ██████  ████████ ███████ 
//  ██      ██      ██   ██ ██ ██   ██    ██    ██      
//  ███████ ██      ██████  ██ ██████     ██    ███████ 
//       ██ ██      ██   ██ ██ ██         ██         ██ 
//  ███████  ██████ ██   ██ ██ ██         ██    ███████ 

    //////////////////////
    // TAB ANIMATOR     //
    //////////////////////

    tl = gsap.timeline();
    startPosIndex = 1;
    reachedEnd    = false;
    activeIndex   = startPosIndex;
    animDuration  = 0.1;
    var liContainer,liEls,slideEl_1,slideEl_2 

    window.addEventListener("load", COM_switchTab);
    window.addEventListener("hashchange", COM_switchTab);

    ////////////////////////////
    // TAB EVENT HANDLER      //
    ////////////////////////////

    function COM_switchTab(sel)
    {
        if(typeof(liContainer)=="undefined")
        {
            liContainer = document.querySelector("ul");
            liEls       = [...document.querySelectorAll("ul a")];
            slideEl_1   = document.querySelector(".focus-el.el--1");
            slideEl_2   = document.querySelector(".focus-el.el--2");

            liRect = liContainer.getBoundingClientRect();
            slideEl_1_DefWidth = slideEl_1.getBoundingClientRect().width;
            slideEl_1_DefLeft  = slideEl_1.getBoundingClientRect().left;
            slideEl_2_DefLeft  = slideEl_2.getBoundingClientRect().left;
        }

        // read hash value from url
        if(typeof(sel)=="string") location.hash = "#"+sel;
        var sel_id = location.hash.slice(1)
        if(sel_id.indexOf("_")>0) sel_id = sel_id.split("_")[0];
        // find tab object corresponding to hash value
        var node = document.getElementById("app").childNodes[1].childNodes;
        for(var index=0,cnt=1;index<node.length;index++)
        {
            if(node[index].href)
            {
                if (node[index].href.split("#")[1] == sel_id || (typeof(el)=="undefined" && cnt == startPosIndex))
                var el = node[index];
                cnt++
            }
        }
        switchTabHeader(tl,index,el.getBoundingClientRect());
        switchTabContent('tabs',el.href.split("#")[1]);
    }

    //////////////////////////////
    // TAB HEADER SELECTOR      //
    //////////////////////////////

    function switchTabHeader(tl,index,elRect)
    {
      if (reachedEnd && index + 1 == startPosIndex)
      {
        tl.to( slideEl_1, animDuration, { left: `${liRect.width}px` });
        tl.to( slideEl_2, animDuration, { left: `${elRect.left - liRect.left}px` },`-=${animDuration}`);
        tl.set(slideEl_1, { left: `${slideEl_1_DefLeft - liRect.left}px` },`+=${animDuration}`);
        tl.set(slideEl_2, { left: `${slideEl_2_DefLeft - liRect.left}px` },`+=${animDuration}`);
      }
      timesWidth = index + 1 - activeIndex + 1 <= 0 ? 1 : index + 1 - activeIndex + 1;
      activeIndex = index + 1;
      tl.to(slideEl_1, animDuration, { width: `${timesWidth * slideEl_1_DefWidth}px` });
      if (index + 1 != startPosIndex || reachedEnd == false)
      {
        tl.to(slideEl_1, animDuration, {
            left: `${elRect.left - liRect.left}px`,
            width: `${slideEl_1_DefWidth}px` });
      }
      reachedEnd = (index + 1 == liEls.length) ? true : false;
    }

    //////////////////////////////
    // TAB CONTENT SELECTOR     //
    //////////////////////////////

    function switchTabContent(node_name,sel_id)
    {
      var node = document.getElementsByClassName(node_name)[0].childNodes
      for(var i=0;i<node.length;i++)
      {
        if(node[i].id)
        {
          if(node[i].id == sel_id) node[i].classList.add('active');
          else                     node[i].classList.remove('active');
        }
      }        
    }

    ////////////////////
    // ON-SCREEN HELP //
    ////////////////////

    function onhelp(txt,target)
    {
        if( typeof(_o.tools[target.id])=="undefined" )
        _o.tools[target.id] = {"toggle":false,"cache":""}

        var t = target.tagName;
        switch(target.tagName.toUpperCase())
        {
        case "DIV":
            _o.tools[target.id].toggle = !_o.tools[target.id].toggle
            if(_o.tools[target.id].toggle)
            {
            _o.tools[target.id].cache = target.innerHTML;
            target.innerHTML = txt;
            }
            else
            target.innerHTML = _o.tools[target.id].cache;
        break;
        case "TEXTAREA":
            target.innerHTML = txt;
        break;
        }
    }


    
    function toggle()
    {
      // AWFUL !!!!!!!!!!!!!! Can someone help me with a clean speaker toggle !
      /*
      if(bOsc) {pulse1.start(); pulse1.stop("+0.01"); }
      else pulse2.start(); pulse2.stop("+0.01");
      bOsc = !bOsc;
      */

      /*
      if(_o.EMU_snd_bpulse) {_o.EMU_snd_pulse1.start(); _o.EMU_snd_pulse1.stop("+0.01") }
                else {    _o.EMU_snd_pulse2.start(); _o.EMU_snd_pulse2.stop("+0.01") }
                _o.EMU_snd_bpulse = !_o.EMU_snd_bpulse;
      */
    }
</script>
</head>




<!--
   ____    ____          _            
  |_   \  /   _|        (_)           
    |   \/   |   ,--.   __   _ .--.   
    | |\  /| |  `'_\ : [  | [ `.-. |  
   _| |_\/_| |_ // | |, | |  | | | |  
  |_____||_____|\'-;__/[___][___||__]
  ██   ██ ████████ ███    ███ ██      
  ██   ██    ██    ████  ████ ██      
  ███████    ██    ██ ████ ██ ██      
  ██   ██    ██    ██  ██  ██ ██      
  ██   ██    ██    ██      ██ ███████ 
-->  
<body>

 <!-- 
  <div id="mocha"></div>
  <script>
  if(typeof(mocha)=="object")
  {
    mocha.setup('bdd');
    mocha.checkLeaks();
    mocha.run();
  }
</script>
-->

  <table id=box style=width:450px;margin-top:0px>
    <tr>
      <td valign=top>
        <!--i class="fa fa-bars" onmouseover="document.getElementById('app').style.display=''" style=float:left;></i!-->

        <!-- tab menu  -->
        <div id=app>
          <ul style="width:350px;float:left">
            <!-- links -->
            <a id="tab0" href="#tab1">Emulator</a>
            <a id="tab0" href="#tab2">Assembler</a>
            <a id="tab0" href="#tab3">Debugger</a>
            <a id="tab0" href="#tab4">Manual</a>
            <div class="focus-el el--1"></div>
            <div class="focus-el el--2"></div>
          </ul>
        </div>
       
        <!-- tab content -->
        <div class="tabs">
          <div id="tab1" style="height:1300px;width:1300px;background-image:url('res/appleIIplus_bck_650_v2.png');background-size:1300px;background-repeat:no-repeat;image-rendering:pixelated;user-select:none;-moz-user-select:none;-webkit-user-drag:none;-webkit-user-select:none;-ms-user-select:none;">
          <!--
            ███████ ███    ███ ██    ██ ██       █████  ████████  ██████  ██████  
            ██      ████  ████ ██    ██ ██      ██   ██    ██    ██    ██ ██   ██ 
            █████   ██ ████ ██ ██    ██ ██      ███████    ██    ██    ██ ██████  
            ██      ██  ██  ██ ██    ██ ██      ██   ██    ██    ██    ██ ██   ██ 
            ███████ ██      ██  ██████  ███████ ██   ██    ██     ██████  ██   ██  
          -->

            <script type="text/javascript" src="res/EMU_apple2main.js"></script>
            <script type="text/javascript" src="res/EMU_cpu6502.js"></script>
            <script type="text/javascript" src="res/EMU_apple2roms.js"></script>
            <script type="text/javascript" src="res/EMU_apple2video.js"></script>
            <script type="text/javascript" src="res/EMU_appledisk2.js"></script>
            <script type="text/javascript" src="res/EMU_ramcard.js"></script>
            <script type="text/javascript" src="res/EMU_apple2io.js"></script>
            <script type="text/javascript" src="res/EMU_apple2hw.js"></script>
            <script type="text/javascript" src="res/EMU_apple2keys.js"></script>
            <script type="text/javascript" src="res/EMU_apple2plus.js"></script>
            <script type="text/javascript" src="res/jsSID.js"></script>            

            <style>
 

            </style>

            <div style="height:115px;padding:0px 0px 0px 0px;">

              <div style="height:30px;padding:0px 90px 0px 0px;">
                <button class=appbut value="Tools" onclick="javascript:onPopup('paste')" title="Tools"><i class="fa fa-toolbox"></i></button>
                <button class=appbut value="Settings" onclick="javascript:onPopup('settings')" title="Settings"><i class="fa fa fa-sliders-h"></i></button>
              </div>
  
              <div class="hints1" id="paste" hidden="" style="position:absolute;left:0px;top:32px;z-index:2;height:80px;">
                <div class=toolbox>
                <form name="EMUboard">
                  <textarea cols=40 rows=4  placeholder="Paste here" name=boardText style="float:left"></textarea><br>
                  <input type="button"  value="Paste"              onclick="javascript:onPasteboard();onBoardPaste()">
                  <input type="button"  value="Capture" id=Capture onclick="javascript:onCapture();onBoardPaste()">                
                  <input type="text"    value="$0000" size=5       onkeyup="onCaptureAddr(this)"><font color="#FFFFF">►</font><input type="text" value="$FFFF" size=5 onkeyup="onCaptureAddr(this)">
                  <input type="button"  value="Clear"              onclick="javascript:onEMUBoardClear()">
                  <input type="button"  value="X"                  onclick="javascript:onPopup('paste')">
                </form>
              </div>
              <div class=toolbox>
                <button class=appbut                 onclick="javascript:alert('no sound implementation')" id="soundbutton"   title="Sound"><i  class="fa fa-volume-mute"></i></button>
                <button class=appbut                 onclick="javascript:pauseButton(this)" id="pausebutton"   title="Pause"><i  class="fa fa-pause"></i></button>
                <br>
                <button class=appbut value="Reset"   onclick="javascript:resetButton()"     id="resetbutton"   title="Reset"><i  class="fa fa-undo-alt"></i></button>
                <button class=appbut value="Restart" onclick="javascript:restartButton()"   id="restartbutton" title="Reboot"><i class="fa fa-power-off"></i></button>
              </div>
              <div class=toolbox>
                <div class=appbut style="padding:5px 5px 5px 5px;margin-top:5px;text-align:center"><button class=appbut value="Drive1" onclick="javascript:restartButton()" onmouseover="this.innerHTML='Restart'" onmouseout="this.innerHTML='Drive1'">Drive1</button> <input type="file"  id="loadfile" value="Disk" onchange="javascript:loadDisk()"></div>
                <!--
                <div class=appbut style="padding:5px 5px 5px 5px;margin-top:5px;text-align:center">Drive2 <input type="file"  id="loadfile" value="Disk" onchange="javascript:loadDisk()"></div>
                -->
                </div>
              </div>

              <div class="hints1" id="settings" hidden="">
                <div class=toolbox>
                  <div class=appbox title="CPU" style="text-align:left;padding:0px 6px 0px 6px;">
                    SYSTEM
                    <div style="font-family:arial;font-size:11px">

                        <div style="float:left;border:0px solid;padding:0px 0px 0px 0px;margin:0px;width:100px;"><div id="cpu_component" style="float:left;border:0px solid;padding:3px"></div>load&nbsp;<i class="fa fa-sync-alt" onclick="onPopUpClass(this,'fa-stop-circle','fa-sync-alt');oEMU.bCPU_monitoring=!!this.hidden;document.getElementById('cpu_pct').value='';"></i><input id="cpu_pct" value="" size="4"></div>
                        <br>
                        <div id="slider_1v" style="float:left;border:0px solid;padding:0px 0px 0px 0px;width:35px;">Speed</div>
                        <input id="myRange" type="range" min="0" max="70" value="35" class="slider" onchange="slider_update(this,70)" style="width:65px">
                        <div id="all_components"></div>
                      <script>
                        function slider_update(obj,max)
                        {
                          var el = obj.getBoundingClientRect()
                          var pct = 2*obj.value/max;
                          var pos = [el.left+4+pct*((el.right-el.left)-17),el.top+2-10]
                          document.getElementById("slider_1v").innerHTML = Math.round(pct*10)*10+"%";
                          _o.CPU_ClockTicks = Math.round( (_o.CPU_ClocksTicks_s*pct) / _o.EMU_Updates_s );
                        }

                        function system_tab_update()
                        {
                          document.getElementById("cpu_component").innerHTML = _CFG_SYSCODE["A2P"].CPU;
                          document.getElementById("all_components").innerHTML = ""
                          //_CFG_SYSCODE[oEMU.system.Video].Display
                          +_CFG_SYSCODE["A2P"].Display+" Vid <i class='fa fa-palette' id='clr' onclick=\"javascript:this.name=(this.name?Number(this.name)+1:1);var m=apple2plus.monitor(this.name);this.style.color=m.color;this.title=m.name\" title='Color mode'></i><br>"
                          +_CFG_SYSCODE["A2P"].KeysROM+" Kbd <i class='fa fa-keyboard' title='Keyboard'></i><i class='fa fa-cog'></i>"
                        }
                      </script>

                    </div>

                </div>
                  
                  <div class=appbox style="height:80px;width:340px;padding:0px 6px 0px 6px;" title="Memory map">
                    <div style="float:left">MEM<br><i class="fa fa-sync-alt" onclick="onPopUpClass(this,'fa-stop-circle','fa-sync-alt');oEMU.bMEM_monitoring=!!this.hidden;"></i></div>
                    <div id="mem_map"></div>
                  </div>

                  <div class=appbox style="height:80px;padding:0px 6px 0px 6px;">
        
                      SLOTS
                    <form name="DEVboard">
                      <div class=appbox style="width:36px;padding:6px 0px 6px 0px;" title="Slot">game<br><button class=appbut onclick="javascript:" id="resetbutton" title="Configure Slot#0" style="margin-left:0px"><i class="fa fa-cog"></i></button></div>
                      <div class=appbox style="width:36px;" title="Slot">#1</div>
                      <div class=appbox style="width:36px;" title="Slot">#2</div>
                      <div class=appbox style="width:36px;" title="Slot">#3</div>
                      <div class=appbox style="width:36px;" title="Slot">#4</div>
                      <div class=appbox style="width:36px;" title="Slot">#5</div>
                      <div class=appbox style="width:36px;" title="Slot">#6<br><button class=appbut onclick="javascript:" id="resetbutton" title="Configure Slot#6"><i class="fa fa-cog"></i></button></div>
                      <div class=appbox style="width:36px;" title="Slot">#7</div>
                    </form>
                
                </div>
              </div>
            </div>
          </div>

            <script type="text/javascript">

            oCOM.addLoadEvent(mem_map);
            function mem_map()
            {
              var linestep = 4096;
                document.getElementById("mem_map").innerHTML = 
                  oMEMGRID.build_grid(7*linestep,8,-linestep) 
                + oMEMGRID.build_grid(15*linestep,8,-linestep);
                oMEMGRID.paint_grid();
            }

            function update_mem_map()
            {

            }

            var bColor = false;
            function onPasteboard() { var e = document.getElementById('paste'); e.hidden = !e.hidden; }
            function onPopup(id) { var e = document.getElementById(id); e.hidden = !e.hidden; }

            function onPopUpClass(id,class1,class2)
            {
              id.hidden = !id.hidden;
              if(id.hidden) {id.classList.remove(class2);id.classList.add(class1)} else {id.classList.remove(class1);id.classList.add(class2)}
            }

            function isHidden(el)
            {
              var style = window.getComputedStyle(el);
              return (style.display === 'none')
            }

            function onBoardPaste()
            {
              var e = EMUboard.boardText.value;
              e = e.replace(/\r\n/g,"\r");
              e = e.replace(/\n/g,"\r");
              for(var _i=0;_i<e.length;_i++)
              {
                  //var event = {"charCode":false,"metaKey":false,"altKey":false,"keyCode":e.charCodeAt(_i)}
                  //apple2OnKeyPress(event);
                  var code = apple2plus.keystroke( {"charCode":false,"metaKey":false,"altKey":false,"keyCode":e.charCodeAt(_i)} );
                  if(e.charCodeAt(_i)==13) apple2plus.cycle(10000 * _o.EMU_IntervalTime_ms);  // carriage return takes more cycle time
                  apple2plus.cycle(1000 * _o.EMU_IntervalTime_ms);
              }
            }
            function onEMUBoardClear() { EMUboard.boardText.value = "" };  
            function onCaptureBase(tag)
            {
              tag.value=tag.value=="hex"?"dec":"hex";
            }
            function onCaptureRange(event,tag,base)
            {
              var template = {"hex":["\\$([0-9A-F]{1,4})►\\$([0-9A-F]{1,4})",16],
                              "dec":["([0-9]{1,5})►([0-9]{1,5})",10]};
              // VALIDATE
              var re = new RegExp(template[base][0],'g');
              var addr_arr = tag.value.replace(re,'$1,$2').split(",");
              document.getElementById('Capture').disabled = addr_arr.length!=2;


              document.getElementById("debug2").value = event.keyCode

              //document.getElementById("debug2").value = "$"+addr_arr.join("►$")
              //alert(tag.value+" ("+tag.value.replace(re,'$1,$2')+")");
           
            }

            function onCaptureAddr(tag)
            {
              var template = {16:"\\$([0-9A-F]{1,4})",
                              10:"([0-9]{1,5})"};
              var base = tag.value.charAt(1)=="$"?16:10;
              var bValid = tag.value.match(template[base])==null?false:tag.value;
              document.getElementById('Capture').disabled = !bValid
              return bValid;
            }

            </script>
            <canvas class="appvid" id="applescreen" width="560" height="384" tabindex="0" style="outline: none !important;padding:0px 0px 0px 0px;" onkeypress="apple2plus.keystroke(event)"></canvas>
            <div class="appdskLED" id="dskLED1" style="left:392px;top:666px"></div>
            <div class="appdskLED" id="dskLED2" style="left:750px;top:666px"></div>
            <div class="appkbd" id="kbdimg" onmousemove=apple2plus.keysObj().KbdHover(event);apple2plus.DiskObj().hide() onmouseout=apple2plus.keysObj().KbdHover(event)>
              <div class="key"  id="keybox" onclick=apple2plus.keystroke(event)></div>

              <!--
            <div class="key"  id="keybox"                                        onclick=apple2OnKeyHover(event)  onmousemove=apple2OnKeyHover(event) onmouseout=apple2OnKeyHover(event) onmouseover=apple2OnKeyHover(event)></div>

              <div class="key"  id="key_rept"   style="visibility:hidden;"       onclick=apple2OnKeyHover(event)  onmousemove=apple2OnKeyHover(event) onmouseout=apple2OnKeyHover(event) onmouseover=apple2OnKeyHover(event)></div>
              <div class="key"  id="key_ctrl"   style="visibility:hidden;"       onclick=apple2OnKeyHover(event) onmousemove=apple2OnKeyHover(event) onmouseout=apple2OnKeyHover(event) onmouseover=apple2OnKeyHover(event)></div>
              <div class="key"  id="key_lshift" style="visibility:hidden;"       onclick=apple2OnKeyHover(event)  onmousemove=apple2OnKeyHover(event) onmouseout=apple2OnKeyHover(event) onmouseover=apple2OnKeyHover(event)></div>
              <div class="key"  id="key_rshift" style="visibility:hidden;"       onclick=apple2OnKeyHover(event)  onmousemove=apple2OnKeyHover(event) onmouseout=apple2OnKeyHover(event) onmouseover=apple2OnKeyHover(event)></div>  
              -->
            </div>
            <!--
            <br>
            <img src=res/appleIIplus_kbd_650.png id=kbdimg style="padding-top:0px;padding-left:105px;opacity:0.5;image-rendering:pixelated;user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-drag:none;-webkit-user-select:none;-ms-user-select:none;" ontouchstart=apple2OnKeyHover_b(event) onclick=apple2OnKeyHover_b(event) onmousemove=apple2OnKeyHover_b(event) onmouseover="apple2OnKeyHover_b(event)" onmouseout="apple2OnKeyHover_b(event)">
            -->
            <!-- TODO: FIND A WAY TO MOVE UP THIS INCLUDE (TRIGGER A FUNCTION ONLOAD ?)-->
            <br>
            
            <input id="debug" style="width:400px" value="1" hidden>
            
          </div>
          <div id="tab2" style="height:1024px;width:700px">
          <!--
            █████  ███████ ███████ ███████ ███    ███ ██████  ██      ███████ ██████  
            ██   ██ ██      ██      ██      ████  ████ ██   ██ ██      ██      ██   ██ 
            ███████ ███████ ███████ █████   ██ ████ ██ ██████  ██      █████   ██████
            ██   ██      ██      ██ ██      ██  ██  ██ ██   ██ ██      ██      ██   ██
            ██   ██ ███████ ███████ ███████ ██      ██ ██████  ███████ ███████ ██   ██
          -->

          <script type="text/javascript" src="res/ASM_core.js"></script>
          <script type="text/javascript" src="res/ASM_6502.js"></script>
          <script type="text/javascript" src="res/ASM_6502_gui.js"></script>
          <link rel="stylesheet"        href="res/ASM_6502.css">
    

          <div style="padding:0px 90px">
            <button class=appbut value="pasteboard" onclick="javascript:onASMPasteboard()" title="ByteCode pasteboard"><i class="fa fa-paste"></i></button>
          </div>
          <div class="hints1" id="bytecodepaste" hidden="" style="z-index:2;position:absolute;left:90px">
            <form name="ASMboard">
            <textarea cols=40 rows=3  placeholder="Paste ByteCode here" name=boardText></textarea>
            </form>
            <input type="button" value="Paste" onclick="javascript:onASMPasteboard();onASMBoardPaste()"><input type="button" value="Clear" onclick="javascript:onASMBoardClear()"><input type="button" value="Hide" onclick="javascript:onASMPasteboard()">
            </div>
          <script type="text/javascript">
            var bColor = false;
            function onASMPasteboard() { var e = document.getElementById('bytecodepaste'); e.hidden = !e.hidden; }
            function onASMBoardPaste()
            {
              var e = ASMboard.boardText.value.toUpperCase(); 
              e = e.replace(/^.*[!-\/;-@G-~].*$/gm,"");   // remove each line with incompliant characters
              e = e.replace(/[\r\n ]/g,"");               // remove all <cr> <lf> <spaces>                
              e = e.replace(/([0-9A-F]{4}:)/g,"\n$1");    // introduce linefeed
              e = e.replace(/([0-9A-F]{2})/g," $1");      // equally separate bytes
              e = e.replace(/ ([0-9A-F]{2}) ([0-9A-F]{2}): /g,"$1$2:"); // re-join 16-bit addresses
              e = e.replace(/^[\s\n]/g,"");               // remove heading spaces and linefeeds
              ass.srcfield.value = e;
              //ass.listing.value = e;
              
              var s = "";
            }
            function onASMBoardClear() { ASMboard.boardText.value = "" }; 
          </script>

          <form name="ass" onsubmit="return false">
            <table style="background:#76B9CE;border-radius:10px;">
              <tr>
                <td valign=top style="display:flex;flex-wrap:wrap;width:340px">
                  <!-- LEFT PANE -->
                  <textarea name="srcfield" onscroll="syncScroll(document.forms.ass.srcfield,document.forms.ass.listing)" class="dotmatrix_bck" style="width:280px;height:400px;margin:10px;overflow:auto;white-space:pre;word-wrap:normal;/*white-space:nowrap;*/" wrap=off placeholder="Source code" autofocus>*=$6000
           LDX #0
    Label1 TXA
           STA $0400,X
           LDA #1
           STA $D800,X
           INX
           BNE Label1
           RTS
    .END
                  </textarea>
                  <br>
                  <button onclick="assemble()/*;document.getElementById('codefield').innerHTML=ass.codefield.value.replace(/\n/g,'<br>')*/"><i class="fa fa-cogs"></i> assemble</button>
                  <button onclick="alert('disassemble')"><i class="fa fa-puzzle-piece"></i> disassemble</button>
                  <button onclick="EMUboard.boardText.value='CALL-151\r\n'+document.getElementById('codefield').innerHTML.replace(/<br>/g,'\n')+'\r\n';onPasteboard();COM_switchTab('tab1')">
                    <i class="fa fa-arrow-circle-up"></i> to emulator</button>
                  <button onclick="document.getElementById('debugfield').innerHTML=document.getElementById('codefield').innerHTML;COM_switchTab('tab3')">
                      <i class="fa fa-arrow-circle-up"></i> to debugger</button>
                  <button onclick="javascript:onToolBox('SrcTools');"><i class="fa fa-wrench"></i> tools & config</button>
    
                  <button onclick="onhelp(_DOCS['ASSEMBLER'],document.getElementById('codefield'))"><i class="fa fa-book"></i> help</button>
                  <!--button onclick="onhelp(asmHelp(),document.getElementById('codefield'))"><i class="fa fa-book"></i> help</!--button-->
    
                  <button onclick="oASM.assemble_step();"><i class="fa fa-road"></i> trace</button>
    
                </td>
                <td valign=top>
                  <!-- RIGHT PANE -->
                  <textarea name="listing" onscroll="syncScroll(document.forms.ass.listing,document.forms.ass.srcfield)" readonly="readonly" wrap="virtual" class="dotmatrix_bck" style="width:340px;height:400px;margin:10px 10px 10px 0px;-webkit-filter: brightness(0.95);filter: brightness(0.95);" placeholder="Listing"></textarea>
                </td>
              </tr>
              <tr>
                <td colspan=2>
                  <div id="SrcTools" hidden="">
                    <script>document.write(sTools);</script>
                  </div>
                </td>
              </tr>
              <tr>
                <td colspan=2 style="background-image:url('res/CRT_TV_50b.png');background-size:800px 560px;background-repeat:no-repeat;image-rendering:pixelated;">
                  <div style="height:90px"></div>
                  <div name="codefield" id="codefield" class="markdown_mon" style="background-color: transparent; border-color: transparent; resize: none;"></div>
                  <div style="height:180px"></div>
                </td>
              </tr>
            </table>
          </form>

          <script>
            function syncScroll(element1, element2) {
              element2.scrollTop = element1.scrollTop;
            }
  
          </script>

          </div>
          <div id="tab3" style="height:250px;width:700px">
          <!--
            ██████  ███████ ██████  ██    ██  ██████   ██████  ███████ ██████ 
            ██   ██ ██      ██   ██ ██    ██ ██       ██       ██      ██   ██
            ██   ██ █████   ██████  ██    ██ ██   ███ ██   ███ █████   ██████
            ██   ██ ██      ██   ██ ██    ██ ██    ██ ██    ██ ██      ██   ██
            ██████  ███████ ██████   ██████   ██████   ██████  ███████ ██   ██
          -->

          <script type="text/javascript" src="res/DBG_6502cpu.js"></script>
          <script type="text/javascript" src="res/DBG_6502gui.js"></script>
        <link rel="stylesheet"        href="res/DBG_6502.css">
  
        <table width="700px" cellspacing="0" cellpadding="0" style="background-color:#76B9CE;border-radius:10px;">
          <tr>
              <td>
            <form action="#" onsubmit="singleStep(); return false"></form>
            <form name="MemLoader" onsubmit="showMem();return false"></form>
            <textarea id="mem" name="mem" rows="16" cols="62" wrap="virtual" hidden=""></textarea>
              </td>
          </tr>
          <tr>
              <td>
              <div>
                <!-- LEFT PANE -->
                       <div class="displayLr" style="float:left;width:250px;height:200px;font-size:small/*;border-style:solid;border-width:1px;border-color:yellow*/">
                   <div id="dispStep" style="width:248px;height:98px;font-size:small;" contenteditable="true" oncut="return false" onpaste="return false" onkeydown="if(event.metaKey) return true; return false;"></div>
                   <div style="width:248px;height:4px"></div>
                   <div id="watchdisp" style="width:248px;height:98px;font-size:small;" contenteditable="true" oncut="return false" onpaste="return false" onkeydown="if(event.metaKey) return true; return false;"></div>
                 </div>
                 <!-- RIGHT PANE -->
                 <div style="float:left;/*border-style:solid;border-width:1px;border-color:yellow;*/">
                   <!-- BEGIN DASHBOARD -->
                  <div id="regdisp" class="regdisp"></div>
                   <table class=dtable>
                             <tr>
                                 <td><a onclick="setRegister('PC'); return false;" onfocus="if(this.blur) this.blur();" title="set PC">PC</a></td>
                                 <td>&nbsp;</td>
                                 <td><a onclick="setRegister('AC'); return false;" onfocus="if(this.blur) this.blur();" title="set AC">A</a></td>
                                 <td><a onclick="setRegister('XR'); return false;" onfocus="if(this.blur) this.blur();" title="set XR">X</a></td>
                                 <td><a onclick="setRegister('YR'); return false;" onfocus="if(this.blur) this.blur();" title="set YR">Y</a></td>
                                 <td><a onclick="setRegister('SR'); return false;" onfocus="if(this.blur) this.blur();" title="set SR">SR</a></td>
                                 <td><a onclick="setRegister('SP'); return false;" onfocus="if(this.blur) this.blur();" title="set SP">SP</a></td>
                             </tr>
                             <tr>
                                 <td><div id="dispPC" class="displayLr" onclick="setRegister('PC'); return false;" style="cursor: pointer;">0000</div></td>
                                 <td>&nbsp;</td>
                                 <td><div id="dispAC" class="displayLr">00</div></td>
                                 <td><div id="dispXR" class="displayLr">00</div></td>
                                 <td><div id="dispYR" class="displayLr">00</div></td>
                                 <td><div id="dispSR" class="displayLr">20</div></td>
                                 <td><div id="dispSP" class="displayLr">FF</div></td>
                             </tr>
                         </table>
                         <table class=dtable>
                             <tr>
                                 <td><a onclick="flipSRBit(7); return false;" onfocus="if(this.blur) this.blur();" title="flip Negative flag">N</a></td>
                                 <td><a onclick="flipSRBit(6); return false;" onfocus="if(this.blur) this.blur();" title="flip Overflow flag">V</a></td>
                                 <td><a onclick="flipSRBit(5); return false;" onfocus="if(this.blur) this.blur();" title="flip bit 5 (ignored)">-</a></td>
                                 <td><a onclick="flipSRBit(4); return false;" onfocus="if(this.blur) this.blur();" title="flip Break flag">B</a></td>
                                 <td><a onclick="flipSRBit(3); return false;" onfocus="if(this.blur) this.blur();" title="flip Decimal flag">D</a></td>
                                 <td><a onclick="flipSRBit(2); return false;" onfocus="if(this.blur) this.blur();" title="flip Interrupt flag">I</a></td>
                                 <td><a onclick="flipSRBit(1); return false;" onfocus="if(this.blur) this.blur();" title="flip Zero flag">Z</a></td>
                                 <td><a onclick="flipSRBit(0); return false;" onfocus="if(this.blur) this.blur();" title="flip Carry flag">C</a></td>
                             </tr>
                             <tr>
                                 <td><div id="dispSR7" class="displayLr">0</div></td>
                                 <td><div id="dispSR6" class="displayLr">0</div></td>
                                 <td><div id="dispSR5" class="displayLr">1</div></td>
                                 <td><div id="dispSR4" class="displayLr">0</div></td>
                                 <td><div id="dispSR3" class="displayLr">0</div></td>
                                 <td><div id="dispSR2" class="displayLr">0</div></td>
                                 <td><div id="dispSR1" class="displayLr">0</div></td>
                                 <td><div id="dispSR0" class="displayLr">0</div></td>
                             </tr>
                         </table>
                         <table class=dtable>
                             <tr>
                                 <td><a onclick="setWatchByte('AD'); return false;" onfocus="if(this.blur) this.blur();" title="set AD">AD</a></td>
                                 <td>&nbsp;</td>
                                 <td><a onclick="setWatchByte('R1'); return false;" onfocus="if(this.blur) this.blur();" title="set R1">R1</a></td>
                                 <td><a onclick="setWatchByte('R2'); return false;" onfocus="if(this.blur) this.blur();" title="set R2">R2</a></td>
                                 <td><a onclick="setWatchByte('R3'); return false;" onfocus="if(this.blur) this.blur();" title="set R3">R3</a></td>
                                 <td><a onclick="setWatchByte('R4'); return false;" onfocus="if(this.blur) this.blur();" title="set R4">R4</a></td>
                                 <td><a onclick="setWatchByte('R5'); return false;" onfocus="if(this.blur) this.blur();" title="set R5">R5</a></td>
                                 <td><a onclick="setWatchByte('R6'); return false;" onfocus="if(this.blur) this.blur();" title="set R6">R6</a></td>
                             </tr>
                             <tr>
                                 <td><div id="dispAD" class="displayLr" onclick="setWatch('AD'); return false;" style="cursor: pointer;">0000</div></td>
                                 <td>&nbsp;</td>
                                 <td><div id="dispR1" class="displayLr">00</div></td>
                                 <td><div id="dispR2" class="displayLr">00</div></td>
                                 <td><div id="dispR3" class="displayLr">00</div></td>
                                 <td><div id="dispR4" class="displayLr">00</div></td>
                                 <td><div id="dispR5" class="displayLr">00</div></td>
                                 <td><div id="dispR6" class="displayLr">00</div></td>
                             </tr>
                         </table>
                         <table class=dtable>
                             <tr>
                                 <td><a onclick="setwatchBit(7); return false;" onfocus="if(this.blur) this.blur();" title="bit7">7</a></td>
                                 <td><a onclick="setwatchBit(6); return false;" onfocus="if(this.blur) this.blur();" title="bit6">6</a></td>
                                 <td><a onclick="setwatchBit(5); return false;" onfocus="if(this.blur) this.blur();" title="bit5">5</a></td>
                                 <td><a onclick="setwatchBit(4); return false;" onfocus="if(this.blur) this.blur();" title="bit4">4</a></td>
                                 <td><a onclick="setwatchBit(3); return false;" onfocus="if(this.blur) this.blur();" title="bit3">3</a></td>
                                 <td><a onclick="setwatchBit(2); return false;" onfocus="if(this.blur) this.blur();" title="bit2">2</a></td>
                                 <td><a onclick="setwatchBit(1); return false;" onfocus="if(this.blur) this.blur();" title="bit1">1</a></td>
                                 <td><a onclick="setwatchBit(0); return false;" onfocus="if(this.blur) this.blur();" title="bit0">0</a></td>
                             </tr>
                      <td><div id="disp7" class="displayLr">0</div></td>
                      <td><div id="disp6" class="displayLr">0</div></td>
                      <td><div id="disp5" class="displayLr">0</div></td>
                      <td><div id="disp4" class="displayLr">0</div></td>
                      <td><div id="disp3" class="displayLr">0</div></td>
                      <td><div id="disp2" class="displayLr">0</div></td>
                      <td><div id="disp1" class="displayLr">0</div></td>
                      <td><div id="disp0" class="displayLr">0</div></td>
                             </tr>
                         </table>
  
                    <!-- END DASHBOARD -->
                 </div>
                 <div style="float:left">
  

<!--

Generate grid

-->

                 <table class=gtable>
                 <tr><td>$0000</td><td id='m0000' class=gtip></td><td id='m0100'></td><td id='m0200'></td><td id='m0300'></td><td id='m0400'></td><td id='m0500'></td><td id='m0600'></td><td id='m0700'></td><td id='m0800'></td><td id='m0900'></td><td id='m0A00'></td><td id='m0B00'></td><td id='m0C00'></td><td id='m0D00'></td><td id='m0E00'></td><td id='m0F00'></td></tr>
                 <tr><td>$1000</td><td id='m1000'></td><td id='m1100'></td><td id='m1200'></td><td id='m1300'></td><td id='m1400'></td><td id='m1500'></td><td id='m1600'></td><td id='m1700'></td><td id='m1800'></td><td id='m1900'></td><td id='m1A00'></td><td id='m1B00'></td><td id='m1C00'></td><td id='m1D00'></td><td id='m1E00'></td><td id='m1F00'></td></tr>
                 <tr><td>$2000</td><td id='m2000'></td><td id='m2100'></td><td id='m2200'></td><td id='m2300'></td><td id='m2400'></td><td id='m2500'></td><td id='m2600'></td><td id='m2700'></td><td id='m2800'></td><td id='m2900'></td><td id='m2A00'></td><td id='m2B00'></td><td id='m2C00'></td><td id='m2D00'></td><td id='m2E00'></td><td id='m2F00'></td></tr>
                 <tr><td>$3000</td><td id='m3000'></td><td id='m3100'></td><td id='m3200'></td><td id='m3300'></td><td id='m3400'></td><td id='m3500'></td><td id='m3600'></td><td id='m3700'></td><td id='m3800'></td><td id='m3900'></td><td id='m3A00'></td><td id='m3B00'></td><td id='m3C00'></td><td id='m3D00'></td><td id='m3E00'></td><td id='m3F00'></td></tr>
                 <tr><td>$4000</td><td id='m4000'></td><td id='m4100'></td><td id='m4200'></td><td id='m4300'></td><td id='m4400'></td><td id='m4500'></td><td id='m4600'></td><td id='m4700'></td><td id='m4800'></td><td id='m4900'></td><td id='m4A00'></td><td id='m4B00'></td><td id='m4C00'></td><td id='m4D00'></td><td id='m4E00'></td><td id='m4F00'></td></tr>
                 <tr><td>$5000</td><td id='m5000'></td><td id='m5100'></td><td id='m5200'></td><td id='m5300'></td><td id='m5400'></td><td id='m5500'></td><td id='m5600'></td><td id='m5700'></td><td id='m5800'></td><td id='m5900'></td><td id='m5A00'></td><td id='m5B00'></td><td id='m5C00'></td><td id='m5D00'></td><td id='m5E00'></td><td id='m5F00'></td></tr>
                 <tr><td>$6000</td><td id='m6000'></td><td id='m6100'></td><td id='m6200'></td><td id='m6300'></td><td id='m6400'></td><td id='m6500'></td><td id='m6600'></td><td id='m6700'></td><td id='m6800'></td><td id='m6900'></td><td id='m6A00'></td><td id='m6B00'></td><td id='m6C00'></td><td id='m6D00'></td><td id='m6E00'></td><td id='m6F00'></td></tr>
                 <tr><td>$7000</td><td id='m7000'></td><td id='m7100'></td><td id='m7200'></td><td id='m7300'></td><td id='m7400'></td><td id='m7500'></td><td id='m7600'></td><td id='m7700'></td><td id='m7800'></td><td id='m7900'></td><td id='m7A00'></td><td id='m7B00'></td><td id='m7C00'></td><td id='m7D00'></td><td id='m7E00'></td><td id='m7F00'></td></tr>
                 <tr><td>$8000</td><td id='m8000'></td><td id='m8100'></td><td id='m8200'></td><td id='m8300'></td><td id='m8400'></td><td id='m8500'></td><td id='m8600'></td><td id='m8700'></td><td id='m8800'></td><td id='m8900'></td><td id='m8A00'></td><td id='m8B00'></td><td id='m8C00'></td><td id='m8D00'></td><td id='m8E00'></td><td id='m8F00'></td></tr>
                 <tr><td>$9000</td><td id='m9000'></td><td id='m9100'></td><td id='m9200'></td><td id='m9300'></td><td id='m9400'></td><td id='m9500'></td><td id='m9600'></td><td id='m9700'></td><td id='m9800'></td><td id='m9900'></td><td id='m9A00'></td><td id='m9B00'></td><td id='m9C00'></td><td id='m9D00'></td><td id='m9E00'></td><td id='m9F00'></td></tr>
                 <tr><td>$A000</td><td id='mA000'></td><td id='mA100'></td><td id='mA200'></td><td id='mA300'></td><td id='mA400'></td><td id='mA500'></td><td id='mA600'></td><td id='mA700'></td><td id='mA800'></td><td id='mA900'></td><td id='mAA00'></td><td id='mAB00'></td><td id='mAC00'></td><td id='mAD00'></td><td id='mAE00'></td><td id='mAF00'></td></tr>
                 <tr><td>$B000</td><td id='mB000'></td><td id='mB100'></td><td id='mB200'></td><td id='mB300'></td><td id='mB400'></td><td id='mB500'></td><td id='mB600'></td><td id='mB700'></td><td id='mB800'></td><td id='mB900'></td><td id='mBA00'></td><td id='mBB00'></td><td id='mBC00'></td><td id='mBD00'></td><td id='mBE00'></td><td id='mBF00'></td></tr>
                 <tr><td>$C000</td><td id='mC000'></td><td id='mC100'></td><td id='mC200'></td><td id='mC300'></td><td id='mC400'></td><td id='mC500'></td><td id='mC600'></td><td id='mC700'></td><td id='mC800'></td><td id='mC900'></td><td id='mCA00'></td><td id='mCB00'></td><td id='mCC00'></td><td id='mCD00'></td><td id='mCE00'></td><td id='mCF00'></td></tr>
                 <tr><td>$D000</td><td id='mD000'></td><td id='mD100'></td><td id='mD200'></td><td id='mD300'></td><td id='mD400'></td><td id='mD500'></td><td id='mD600'></td><td id='mD700'></td><td id='mD800'></td><td id='mD900'></td><td id='mDA00'></td><td id='mDB00'></td><td id='mDC00'></td><td id='mDD00'></td><td id='mDE00'></td><td id='mDF00'></td></tr>
                 <tr><td>$E000</td><td id='mE000'></td><td id='mE100'></td><td id='mE200'></td><td id='mE300'></td><td id='mE400'></td><td id='mE500'></td><td id='mE600'></td><td id='mE700'></td><td id='mE800'></td><td id='mE900'></td><td id='mEA00'></td><td id='mEB00'></td><td id='mEC00'></td><td id='mED00'></td><td id='mEE00'></td><td id='mEF00'></td></tr>
                 <tr><td>$F000</td><td id='mF000'></td><td id='mF100'></td><td id='mF200'></td><td id='mF300'></td><td id='mF400'></td><td id='mF500'></td><td id='mF600'></td><td id='mF700'></td><td id='mF800'></td><td id='mF900'></td><td id='mFA00'></td><td id='mFB00'></td><td id='mFC00'></td><td id='mFD00'></td><td id='mFE00'></td><td id='mFF00'></td></tr>
                 </table>
  
                 <script>
                  var sys = "A2P"
                  var lbl = {
                             "A2P":{
                             "0000-00FF":["#FFFFFF","zero-page"]
                            ,"0100-01FF":["#E0E0E0","stack"]
                            ,"0200-02FF":["#00D000","GETLN buffer"]
                            ,"0300-03FF":["#00D000","Vector pointers"]
                            ,"0400-07FF":["#DF48FF","TXT1/LORES1"]
                            ,"0800-0BFF":["#D040E0","TXT2/LORES2"]
                            ,"0C00-1FFF":["#00D000","APPLESOFT PRG"]
                            ,"2000-3FFF":["#0000FF","HIRES1"]
                            ,"4000-5FFF":["#0000E0","HIRES2"]
                            ,"C000-CFFF":["#D0D000","I/O"]
                            ,"D000-F7FF":["#D00000","BASIC ROM"]
                            ,"F800-FFFF":["#C00000","Monitor ROM"]
                            ,"0300":["","GETLN"]
                            }
                          }
  
                   // PREPARE ALL DATA
                   var blk_col = {}, blk_txt = {} //, c = ""
                   for(var i in lbl[sys])
                   {
                     var a = i.split("-"); var b = [parseInt(a[0],16),parseInt(a[1],16)];
                     for(var j=b[0];j<b[1];j+=parseInt("0100",16))
                     { //c += ("0000"+j.toString(16)).slice(-4).toUpperCase()+" "+blk[i][0]+"<br>";
                       var idx = ("0000"+j.toString(16)).slice(-4).toUpperCase();
                       blk_col[idx] = lbl[sys][i][0]; blk_txt[idx] = lbl[sys][i][1];
                     }
                   } //document.write(c)
  
                   // DISPLAY GRID
                   /*
                   var s = "<table border=1 style='width:180px;height:180px;margin-left:10px'>"
                   for(var i=0;i<16;i++)
                   {
                     s+="<tr><td style='font-size:xx-small;padding:0px;margin:0px;width:20%'>$"+i.toString(16).toUpperCase()+"000</td>"
                     for(var j=0;j<16;j++)
                     {
                       var b = i.toString(16).toUpperCase() + j.toString(16).toUpperCase() + "00";
                       s+="<td id='m"+b+"' class=gtip></td>";
                     }
                     s+="</tr>\n"
                   }
                   s+="</table>"
                   document.write("<textarea>"+s+"</textarea>")
                   */
  
                   // PAINT GRID
                   for(var i in lbl[sys])
                   {
                     var a = i.split("-");
                     if(a.length==2)
                     {
                       var b = [parseInt(a[0],16),parseInt(a[1],16)];
                       for(var j=b[0];j<b[1];j+=parseInt("0100",16))
                       {
                         var idx = ("000"+j.toString(16)).slice(-4).toUpperCase();
                         var el = document.getElementById("m"+idx);
                         if(blk_col[idx].charAt(0)=="#") el.style.backgroundColor = blk_col[idx];
                         el.innerHTML = "<span class=gt>"+blk_txt[idx]+"</span>"
                       }
                     }
                   }
  
                   //alert(document.getElementById("m0000"))
                   //document.write("<button onclick=alert(document.getElementById('m0000'))>TEST</button>")
  
                   //document.getElementById("m0000").style.backgroundColor = "red";
  /*
                  var s = "<table border=1 style='width:180px;height:180px;margin-left:10px'>"
                  for(var i=0;i<16;i++)
                  {
                    s+="<tr><td style='font-size:xx-small;padding:0px;margin:0px;width:20%'>$"+i.toString(16).toUpperCase()+"000</td>"
                    for(var j=0;j<16;j++)
                    {
                      var blk = i.toString(16).toUpperCase() + j.toString(16).toUpperCase() + "00";
                      s+="<td style='width:5%;background-color:"+blk_col[blk]+"' class='tooltip'>"
                      +(blk_txt[blk]?("<span class='tooltiptext'>"+blk_txt[blk]+"</span>"):"")
                      +"</td>";
                    }
                    s+="</tr>"
                  }
                  s+="</table>"
                //document.write(s);
  */
                </script>
  
  
                 </div>
            </div>
              </td>
          </tr>
        <tr>
          <td>
            <!--div style="float:left;">start&nbsp;$</div><div onclick='chage_adr(this)' style="border-style: solid;border-width:1px; width:100px;">6000</div-->
            <input type="text" id="memAddr" name="memAddr" size="4" value="6000" hidden="" style="float:left;">
  
            <script>
            var oBASE = new function() {
                this.convert = function (str, fromBase, toBase)
                {
                  if(typeof(fromBase)=='object') { this.fromSymbols = fromBase[0] }
                  if(typeof(toBase)  =='object') { this.toSymbols = toBase[0] }
                  fromBase = this.fromSymbols.length; toBase = this.toSymbols.length;

                  // PARSE INPUT DIGITS ARRAY
                  for(var _a = [0], str = str.split(''); str.length > 0 && _a[_a.push(this.fromSymbols.indexOf(str.pop())) - 1] >= 0;);
                  var _d = _a.shift() + _a[_a.length-1]>=0 ? _a : null; if (_d === null) return null;

                  // BASE CONVERSION
                  for (var _n = 0,_a = [],_p = [1]; _n < _d.length; _n++) { _a = add(_a, mul(_d[_n], _p, toBase), toBase); _p = mul(fromBase, _p, toBase) }

                  // PARSE OUTPUT DIGITS ARRAY
                  for (var _n = _a.length - 1, _o = ''; _n >= 0; _o += this.toSymbols[_a[_n--]]);
                  return _o.length==0?this.toSymbols[0]:_o;
                }

                var add = function(x, y, base) {
                    var _m = Math.max(x.length, y.length);
                    for(var _c = 0,_n = 0,_r = [],_z; _n < _m || _c; _c = Math.floor(_z / base)) {
                      var _z = _c + (_n < x.length ? x[_n] : 0) + (_n < y.length ? y[_n] : 0);
                      var _n =  _r.push(_z % base);
                    }
                    return _r;
                }

                var mul = function(x, pow, base) {
                    for(var _r = x < 0 ? null : []; x > 0; x = x >> 1) {
                      if(x & 1) _r = add(_r, pow, base);
                      pow = add(pow, pow, base);
                    }
                    return _r;
                }
            }()
            </script>

            <!--button style="float:left"><i class="fa fa-play"></i>start at $6000</button-->
            <button onclick="debugReset();load_adr(this)" style="float:left">
              <i class="fa fa-truck"></i> load at addr</button>
            <button onclick="singleStep()" style="float:left;"><i class="fa fa-paw">
              </i> step</button>
          </td>
        </tr>
          <tr>
              <td>
                  <button onclick="javascript:onToolBox('DbgTools')"><i class="fa fa-wrench">
              </i> tools & config</button>
              <button onclick="onhelp(_DOCS['DEBUGGER'],document.getElementById('debugfield'));">
                  <!--button onclick="onhelp(DbgHelp(),document.getElementById('debugfield'));"-->
  
              <i class="fa fa-book"></i> help</!--button>
                  <div id="DbgTools" hidden="">
                      <input type="button" value="continous run" class="isButton" onclick="run()">
              <input type="button" value="reset debugger" class="isButton" onclick="debugReset()">
                      <input type="button" value="look up mem #" class="isButton" onclick="memLookup()">
                      <input type="button" value="reset CPU" class="isButton" onclick="masterReset()">
                      show ASCII <input type="checkbox" id="showASCII" value="1" class="formField"><br>
                      <input type="button" value="load C64 ROMs" class="isButton" onclick="loadC64Roms()">
              <input type="button" value="load AppleII+ ROMs" class="isButton" onclick="loadApple2PlusRoms()">
              <input type="button" value="load AppleII+ DEBUG" class="isButton" onclick="loadApple2PlusRoms('DBG')">
              <input type="button" value="map AppleII+ zero-page" class="isButton" onclick="onhelp(_DOCS['ZEROPAGE_APPLE2PLUS,document.getElementById('debugfield'))">
              <input type="button" value="memory MAP" class="isButton" onclick="RAM_checksum()">
                      <iframe name="c64loader" border="0" framespacing="0" marginwidth="0" marginheight="0" width="0" height="0" frameborder="0"></iframe>
                      <input type="button" value="&nbsp;show memory&nbsp;" class="isButton" onclick="showMem()">
                      <div id="dispCycles" class="displayLr">total cycles: 0</div>
              <input id="watchparam" value="" style="width:300px">
              <input id="watchparam2" value="" style="width:300px">
                  </div>
              </td>
          </tr>
          <tr>
              <td colspan=2 style="background-image:url('res/CRT_TV_50b.png');background-size:800px 560px;background-repeat:no-repeat;image-rendering:pixelated;">
                  <div style="height:90px">
                  </div>
                  <div id="debugfield" contenteditable="true" class="markdown_mon"
                      style="width:350px;height:270px;margin-left:105px;white-space:normal;word-break:break-all;overflow-wrap:anywhere;overflow-y:scroll">
                  <div>
                  <!--textarea name="debugfield" hidden=""></!--textarea-->
                  <div style="height:180px">
                  </div>
                  </div>
              </td>
          </tr>
      </table>


          </div>
          <div id="tab4" style="height:1000px;width:700px">
          <!--
            ███    ███  █████  ███    ██ ██    ██  █████  ██
            ████  ████ ██   ██ ████   ██ ██    ██ ██   ██ ██
            ██ ████ ██ ███████ ██ ██  ██ ██    ██ ███████ ██
            ██  ██  ██ ██   ██ ██  ██ ██ ██    ██ ██   ██ ██
            ██      ██ ██   ██ ██   ████  ██████  ██   ██ ███████ 
          -->
          <table width="700px" cellspacing="0" cellpadding="0" style="background-color:#76B9CE;border-radius:10px;">
            <tr>
            <td style="background-image:url('res/CRT_TV_50b.png');background-size:800px 560px;background-repeat:no-repeat;image-rendering:pixelated;">
              <div style="height:90px"></div>
              <div contenteditable="true" class="markdown_mon"><script>document.write(_DOCS['6502'])</script></div>
              <div style="height:180px"></div>
            </td>
          </tr>
          </table>

          </div>
        </div>
      </td>
  </tr>
</table>

</body>
<footer><small><a href=https://github.com/RetroAppleJS/RetroAppleJS.github.io>GitHub</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=https://raw.githubusercontent.com/RetroAppleJS/RetroAppleJS.github.io/main/LICENSE.md>Copyright (c) 2022, Freddy Vandriessche</a></small></footer>
</html>